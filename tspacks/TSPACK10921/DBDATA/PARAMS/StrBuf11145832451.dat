select 1
from orders o, orders op,
  op_values opv, o_good_item ogi, g_unit gu, good g, specgoods s
where opv.op_code = 'MOUNTHTECH'
  and opv.opvalue = 'Y'
  and opv.order_id = ogi.order_id
  and ogi.g_unit_id = gu.g_unit_id
  and gu.good_code = g.good_code
  and g.good_code = s.good_code
  and s.st_code = 'HI_PC_DEP'
  and opv.order_id = op.order_id
  and o.order_id = :vorderid
  and o.ot_code = 'ZADDR'
  and op.ot_code in ('ZORDR','ZPDS')
  and op.chainnum = o.chainnum
  and (
    exists(select 1 from specgoods s
	  where s.good_code = gu.good_code and s.st_code = 'HITECH_SRV')
    or
    not exists(select 1 from scontract_good scg where scg.og_item_id = ogi.og_item_id)
  )
  and rownum = 1


