<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.4.45" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="37839,4226526042" ReportOptions.Description.Text="" ReportOptions.LastChange="41119,8952815741" ScriptLanguage="PascalScript" ScriptText.Text="procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dstLogo.Open;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Picture1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   if &#60;odsADDR.&#34;WBLTYPE&#34;&#62; = 'EIS' then&#13;&#10;     Picture1.Visible := False;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  odsOptions.Open;&#13;&#10;  if &#60;odsOptions.&#34;value&#34;&#62; = 'Y' then&#13;&#10;    Memo4.Memo.Text := &#60;odsORDER.&#34;ORDERID39&#34;&#62;&#13;&#10;  else&#13;&#10;    Memo4.Memo.Text := &#60;odsORDER.&#34;ORDERID&#34;&#62;;&#13;&#10;  Memo4.Font.Name := 'C39HrP48DmTt';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure odsORDERPKNOTEOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if &#60;odsORDER.&#34;PKNOTE&#34;&#62; = '' then&#13;&#10;    odsORDERPKNOTE.Visible := False&#13;&#10;  else&#13;&#10;    odsORDERPKNOTE.Visible := True;                                                              &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="08446174617365747301010C2800000020446174615365743D226473744C6F676F2220446174615365744E616D653D226473744C6F676F2200010C3600000020446174615365743D22667244425F426173655461626C652220446174615365744E616D653D22667244425F426173655461626C652200010C2800000020446174615365743D226F6473414444522220446174615365744E616D653D226F6473414444522200010C2E00000020446174615365743D226F64734F7074696F6E732220446174615365744E616D653D226F64734F7074696F6E732200010C2A00000020446174615365743D226F64734F524445522220446174615365744E616D653D226F64734F52444552220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDOAQuery Name="odsORDER" UserName="odsORDER" CloseDataSource="True" FieldAliases.Text="STAFF_ID=STAFF_ID&#13;&#10;NAME=NAME&#13;&#10;ORDERID39=ORDERID39&#13;&#10;ORDERID=ORDERID&#13;&#10;ORDER_ID=ORDER_ID&#13;&#10;DOCDATE=DOCDATE&#13;&#10;OT_CODE=OT_CODE&#13;&#10;CHAINNUM=CHAINNUM&#13;&#10;OS_CODE=OS_CODE&#13;&#10;ADDRESS_ID=ADDRESS_ID&#13;&#10;FINISH_DATE=FINISH_DATE&#13;&#10;DESIREDDT=DESIREDDT&#13;&#10;HASLOCALITEMS=HASLOCALITEMS&#13;&#10;HASREMOTEITEMS=HASREMOTEITEMS&#13;&#10;CREATEDATETIME=CREATEDATETIME&#13;&#10;CREATEUSERCODE=CREATEUSERCODE&#13;&#10;CHANGEDATETIME=CHANGEDATETIME&#13;&#10;CHANGEUSERCODE=CHANGEUSERCODE&#13;&#10;SRCDOBJCODE=SRCDOBJCODE&#13;&#10;OUTERID=OUTERID&#13;&#10;PARENT_ORDER_ID=PARENT_ORDER_ID&#13;&#10;STRG_ID=STRG_ID&#13;&#10;STORAGE_CODE=STORAGE_CODE&#13;&#10;WERK_CODE=WERK_CODE&#13;&#10;CONTRAGENT_ID=CONTRAGENT_ID&#13;&#10;CURRENCY=CURRENCY&#13;&#10;WL_ID=WL_ID&#13;&#10;IS_SOGL=IS_SOGL&#13;&#10;CARD_NMBR=CARD_NMBR&#13;&#10;PKREAS=PKREAS&#13;&#10;PKNOTE=PKNOTE&#13;&#10;DOC_NMBR=DOC_NMBR" Master="frDB_BaseTable" Session="DBM.OraSession" Active="False" Debug="False" MasterFields="order_id" Params.PropData="04446174610A270000000300000001000000090000003A4F524445525F4944050000000600000033363334310000000000" SQL.Text="SELECT&#13;&#10;  s.staff_id,&#13;&#10;  s.name,&#13;&#10;  '*'||LPAD(o.order_id,12,'0')||DIGITTOCODE39(o.order_id)||'*' as orderid39,&#13;&#10;  '*'||LPAD(o.order_id,12,'0')||'*' as orderid,&#13;&#10;  o.*,&#13;&#10;  NVL( (SELECT MAX('Y') FROM o_good_item ogi, g_unit gu&#13;&#10;        WHERE ogi.order_id = o.order_id&#13;&#10;          AND gu.g_unit_id = ogi.g_unit_id&#13;&#10;          AND gu.good_code = '99000112'), 'N' )AS is_sogl,&#13;&#10;  GET_OP_VALUES(ogi.order_id, ogi.og_item_id, 'CARD_XCHNG') AS CARD_NMBR,&#13;&#10;  (SELECT MAX(ssr.reason_name) FROM sksubst_reason ssr WHERE ssr.reason_code = GET_OP_VALUES(ogi.order_id, ogi.og_item_id, 'PKREAS')) AS PKREAS,&#13;&#10;  GET_OP_VALUES(ogi.order_id, ogi.og_item_id, 'PKNOTE') AS PKNOTE,&#13;&#10;  GET_OP_VALUES(ogi.order_id, ogi.og_item_id, 'DOC_NMBR') AS DOC_NMBR&#13;&#10;FROM orders o, staff s, op_values ov, o_good_item ogi&#13;&#10;WHERE o.order_id=:order_id&#13;&#10;  AND o.createusercode=s.user_code(+)&#13;&#10;  AND o.order_id = ogi.order_id&#13;&#10;  AND ogi.order_id = ov.order_id&#13;&#10;  AND ogi.og_item_id = ov.og_item_id&#13;&#10;  AND ov.op_code = 'PK_SUBST'&#13;&#10;  AND ov.opvalue = 'Y'" PropData="05704C65667402540470546F70023C095661726961626C657301010C480000002044617461547970653D226674537472696E6722204E616D653D224F524445525F49442220506172616D547970653D227074556E6B6E6F776E222056616C75653D223336333431220000"/>
    <TfrxDOAQuery Name="odsOptions" UserName="odsOptions" CloseDataSource="True" FieldAliases.Text="" Session="DBM.OraSession" Active="False" Debug="False" SQL.Text="SELECT&#13;&#10;  value&#13;&#10;FROM tsoptions&#13;&#10;WHERE optcode = 'CODE39'" PropData="05704C65667402540470546F70033401095661726961626C65730100"/>
    <TfrxDOAQuery Name="odsADDR" UserName="odsADDR" CloseDataSource="True" FieldAliases.Text="" Master="frDB_BaseTable" Session="DBM.OraSession" Active="False" Debug="False" MasterFields="order_id" Params.PropData="04446174610A270000000300000001000000090000003A4F524445525F4944050000000600000033363334310000000000" SQL.Text="SELECT&#13;&#10;  WT.WBLTYPE,&#13;&#10;  W.WERK_CODE,&#13;&#10;  pk_franch.get_werkname('ORDERS',:order_id,'PHYSADDR') as CLNT_NAME,&#13;&#10;  a.CITY || case when not a.CITY is null then ', ' else '' end ||&#13;&#10;  a.STREET || case when not a.STREET is null then ', ' else '' end ||&#13;&#10;  a.HOUSE_NUM || case when not a.HOUSE_NUM is null then ', ' else '' end ||&#13;&#10;  case when not a.house_corp is null then 'êîðï. '||a.house_corp||', ' else '' end ||&#13;&#10;  case when not a.BUILDING is null then 'ñòð. '||a.BUILDING||', ' else '' end ||&#13;&#10;  case when not a.ROOM_NUMBER is null then 'ê.' else '' end || a.ROOM_NUMBER&#13;&#10;    AS CLNT_ADDR,&#13;&#10;  'ÈÍÍ '||abn.INN as INN,&#13;&#10;  ac.value as tel&#13;&#10;FROM&#13;&#10;  address a, addr_bninfo abn, addr_comm ac, w_type wt, werk w&#13;&#10;WHERE a.address_id = pk_franch.get_addr_id('ORDERS',:order_id, 'PHYSADDR')&#13;&#10;  AND abn.address_id(+) = a.address_id&#13;&#10;  AND ac.address_id(+) = a.address_id&#13;&#10;  AND ac.ct_code(+) = 'TEL'&#13;&#10;  AND wt.wtype_code = w.wtype_code AND w.is_base = 'Y'" PropData="05704C65667403F8000470546F70023C095661726961626C657301010C480000002044617461547970653D226674537472696E6722204E616D653D224F524445525F49442220506172616D547970653D227074556E6B6E6F776E222056616C75653D223336333431220000"/>
    <TfrxDOAQuery Name="dstLogo" UserName="dstLogo" CloseDataSource="True" FieldAliases.Text="" Session="DBM.OraSession" Active="False" Debug="False" SQL.Text="SELECT&#13;&#10;  tsdf.* --df_value&#13;&#10;FROM&#13;&#10;  tsys_datafiles tsdf,&#13;&#10;  (SELECT wt.wbltype FROM w_type wt, werk w WHERE wt.wtype_code = w.wtype_code AND w.is_base = 'Y') wtc&#13;&#10;WHERE&#13;&#10;  tsdf.df_guid IN (&#13;&#10;  '{1F73DB37-363A-4A98-8846-E9CE9857B27C}',&#13;&#10;  '{031FE881-FC68-41A7-BAF6-E342B446448B}')&#13;&#10;  AND tsdf.df_note = wtc.wbltype" PropData="05704C65667402540470546F70038800095661726961626C65730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="5" BottomMargin="5" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="152,11812" Left="0" Top="18,89765" Width="755,906" PrintChildIfInvisible="True">
      <TfrxPictureView Name="Picture1" Left="0" Top="0,220469999999992" Width="312" Height="64" OnBeforePrint="Picture1OnBeforePrint" DataField="DF_VALUE" DataSet="dstLogo" DataSetName="dstLogo" HightQuality="False"/>
      <TfrxMemoView Name="Memo4" Left="450" Top="12,22047" Width="257" Height="49" OnBeforePrint="Memo4OnBeforePrint" Font.Charset="1" Font.Color="0" Font.Height="-48" Font.Name="Arial" Font.Style="0" HAlign="haRight" HideZeros="True" ParentFont="False" Text="[odsORDER.&#34;ORDERID&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="2" Top="68,22047" Width="438,45671" Height="67,11812" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HideZeros="True" ParentFont="False" WordWrap="False" Text="[odsADDR.&#34;WERK_CODE&#34;]&#13;&#10;[odsADDR.&#34;CLNT_NAME&#34;]&#13;&#10;[odsADDR.&#34;CLNT_ADDR&#34;]&#13;&#10;[odsADDR.&#34;INN&#34;]&#13;&#10;Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½ [odsADDR.&#34;TEL&#34;]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="25,55906" Left="0" Top="540,47279" Width="755,906">
      <TfrxMemoView Name="Memo39" Left="297,77953" Top="3,74805345999994" Width="132" Height="18" HideZeros="True" WordWrap="False" Text="Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° [PAGE#]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="MasterHeader1" Height="67,7953" Left="0" Top="230,55133" Width="755,906" PrintChildIfInvisible="True">
      <TfrxMemoView Name="Memo7" Left="97,86611" Top="32,15739" Width="625,73253" Height="18" AutoWidth="True" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Courier New" Font.Style="1" HideZeros="True" ParentFont="False" WordWrap="False" Text="Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ Ð·Ð°Ð¼ÐµÐ½Ñ‹ ÐŸÐ¾Ð´Ð°Ñ€Ð¾Ñ‡Ð½Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ñ‹ â„– [odsORDER.&#34;ORDER_ID&#34;] Ð¾Ñ‚ [&#60;odsORDER.&#34;CREATEDATETIME&#34;&#62; #ddd.mm.yyyy hh:nn]"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData1" Height="158,74026" Left="0" Top="321,26005" Width="755,906" ColumnWidth="0" ColumnGap="0" DataSet="odsORDER" DataSetName="odsORDER" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="40,99969" Top="142,00773" Width="487,80334" Height="14" DisplayFormat.FormatStr="DD.MM.YYYY HH:NN" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier New" Font.Style="0" HideZeros="True" ParentFont="False" WordWrap="False" Text="Ð”Ð»Ñ Ð¿Ñ€ÐµÐ´ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð½Ð° ÐºÐ°ÑÑÐµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÐµÐ½ Ð´Ð¾: [odsORDER.&#34;FINISH_DATE&#34;]"/>
      <TfrxMemoView Name="odsORDERCARD_NMBR" Left="37,7953" Top="30,23624" Width="680,3154" Height="18,89765" DataSet="odsORDER" DataSetName="odsORDER" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="â„– ÑÑ‚Ð°Ñ€Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ñ‹:   [odsORDER.&#34;CARD_NMBR&#34;]"/>
      <TfrxMemoView Name="odsORDERPKREAS" Left="37,7953" Top="49,13389" Width="680,3154" Height="18,89765" DataSet="odsORDER" DataSetName="odsORDER" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð° Ð·Ð°Ð¼ÐµÐ½Ñ‹:   [odsORDER.&#34;PKREAS&#34;]"/>
      <TfrxMemoView Name="odsORDERPKNOTE" Left="37,7953" Top="68,03154" Width="680,3154" Height="18,89765" OnBeforePrint="odsORDERPKNOTEOnBeforePrint" StretchMode="smActualHeight" DataSet="odsORDER" DataSetName="odsORDER" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ:  [odsORDER.&#34;PKNOTE&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
