<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.13.1" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="37846,4407079167" ReportOptions.Description.Text="" ReportOptions.LastChange="41345,6592691088" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  ActdeedNo, NewActdeedNo, id: String;&#13;&#10;  &#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  ActdeedNo    := &#60;odsOrder.&#34;ACTDEEDNO&#34;&#62;;&#13;&#10;  NewActdeedNo := 'N';&#13;&#10;&#13;&#10;  if ActdeedNo = '0' then&#13;&#10;  begin&#13;&#10;    ActdeedNo    := &#60;odsWerk.&#34;MAXACTDEEDNO&#34;&#62;;&#13;&#10;    NewActdeedNo := 'Y';&#13;&#10;&#13;&#10;    id := &#60;odsOrder.&#34;ORDER_ID&#34;&#62;;&#13;&#10;    odsActdeed.Close;&#13;&#10;    odsActdeed.SetVariable('order_id',id);&#13;&#10;    odsActdeed.SetVariable('Actdeedno',ActDeedNo);&#13;&#10;    odsActdeed.SetVariable('newactdeedno',NewActdeedNo);&#13;&#10;    odsActdeed.ExecSQL;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo19OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var i: integer;                                  &#13;&#10;begin&#13;&#10;  for i:=0 to 3-Length(ActdeedNo) do&#13;&#10;  begin&#13;&#10;    ActdeedNo := '0'+ActdeedNo;                        &#13;&#10;  end;&#13;&#10;  Memo19.Memo.Text := VarToStr(&#60;odsWerk.&#34;WERK_CODE&#34;&#62;)+' / '+'Ñ'+ActdeedNo;                                                  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="08446174617365747301010C3600000020446174615365743D22667244425F426173655461626C652220446174615365744E616D653D22667244425F426173655461626C652200010C2800000020446174615365743D226F64735765726B2220446174615365744E616D653D226F64735765726B2200010C2A00000020446174615365743D226F64734F726465722220446174615365744E616D653D226F64734F726465722200010C2E00000020446174615365743D226F6473416374646565642220446174615365744E616D653D226F6473416374646565642200010C2C00000020446174615365743D226F6473474974656D732220446174615365744E616D653D226F6473474974656D73220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDOAQuery Name="odsWerk" UserName="odsWerk" CloseDataSource="True" FieldAliases.Text="WERK_CODE=WERK_CODE&#13;&#10;NAMEBASE=NAMEBASE&#13;&#10;ADDR=ADDR&#13;&#10;MAXACTDEEDNO=MAXACTDEEDNO" BCDToCurrency="False" Session="DBM.OraSession" Active="False" Debug="False" SQL.Text="select w.werk_code, a.namebase,&#13;&#10;  a.post_code || case when not a.post_code is null then ', ' else '' end ||&#13;&#10;  a.CITY || case when not a.CITY is null then ', ' else '' end ||&#13;&#10;  a.STREET || case when not a.STREET is null then ', ' else '' end ||&#13;&#10;  a.HOUSE_NUM || case when not a.HOUSE_NUM is null then ', ' else '' end ||&#13;&#10;  case when not a.house_corp is null then 'êîðï. '||a.house_corp||', ' else '' end ||&#13;&#10;  case when not a.BUILDING is null then 'ñòð. '||a.BUILDING||', ' else '' end ||&#13;&#10;  case when not a.ROOM_NUMBER is null then 'ê.' else '' end || a.ROOM_NUMBER&#13;&#10;    AS ADDR,&#13;&#10;  TS_DOCNUMBERS.GetNextNumber( 'ORDERS', 'ACTDEED', 'GISSUE', 'N' ) maxactdeedno&#13;&#10;from address a, werk w, wp_link wp&#13;&#10;where w.is_base = 'Y' and w.werk_code = wp.werk_code&#13;&#10;  and a.address_id = wp.address_id and wp.wp_code = 'PHYSADDR'" PropData="05704C656674025C0470546F700234095661726961626C65730100"/>
    <TfrxDOAQuery Name="odsOrder" UserName="odsOrder" CloseDataSource="True" FieldAliases.Text="ORDER_ID=ORDER_ID&#13;&#10;ACTDEEDNO=ACTDEEDNO" BCDToCurrency="False" Master="frDB_BaseTable" Session="DBM.OraSession" Active="False" Debug="False" MasterFields="order_id" Params.PropData="04446174610A270000000300000001000000090000003A4F524445525F4944050000000600000033313936360000000000" SQL.Text="select o.order_id,&#13;&#10;  nvl((select max(opvalue) from op_values opv&#13;&#10;       where opv.order_id = /*29521*/ :order_id&#13;&#10;         and op_code = 'ACTDEED'), 0 ) as ActdeedNo&#13;&#10;from orders o&#13;&#10;where o.order_id = /*29521*/ :order_id" PropData="05704C65667403A4000470546F700234095661726961626C657301010C480000002044617461547970653D226674537472696E6722204E616D653D224F524445525F49442220506172616D547970653D227074556E6B6E6F776E222056616C75653D223331393636220000"/>
    <TfrxDOAQuery Name="odsActdeed" UserName="odsActdeed" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Session="DBM.OraSession" Active="False" Debug="False" Params.PropData="04446174610A5800000003000000030000000D0000003A4E4557414354444545444E4F0500000000000000000000000A0000003A414354444545444E4F050000000000000000000000090000003A4F524445525F4944050000000000000000000000" SQL.Text="begin&#13;&#10;  if :newactdeedno = 'Y' then&#13;&#10;    :actdeedno := TS_DOCNUMBERS.GetNextNumber( 'ORDERS', 'ACTDEED', 'GISSUE', 'Y' );&#13;&#10;  end if;&#13;&#10;&#13;&#10;  update op_values&#13;&#10;     set opvalue = to_number(:actdeedno)&#13;&#10;   where order_id = :order_id&#13;&#10;     and op_code = 'ACTDEED';&#13;&#10;&#13;&#10;  if sql%rowcount = 0 then&#13;&#10;    insert into op_values(order_id, og_item_id, op_code, opvalue)&#13;&#10;    values (:order_id, null, 'ACTDEED', to_number(:actdeedno));&#13;&#10;  end if;&#13;&#10;&#13;&#10;  commit;&#13;&#10;end;" PropData="05704C656674033C010470546F700234095661726961626C657301010C3E0000002044617461547970653D226674537472696E6722204E616D653D224E4557414354444545444E4F2220506172616D547970653D227074556E6B6E6F776E2200010C3B0000002044617461547970653D226674537472696E6722204E616D653D22414354444545444E4F2220506172616D547970653D227074556E6B6E6F776E2200010C3A0000002044617461547970653D226674537472696E6722204E616D653D224F524445525F49442220506172616D547970653D227074556E6B6E6F776E220000"/>
    <TfrxDOAQuery Name="odsGItems" UserName="odsGItems" CloseDataSource="True" FieldAliases.Text="GOOD_CODE=GOOD_CODE&#13;&#10;NAME=NAME&#13;&#10;QUANTITY=QUANTITY" BCDToCurrency="False" Master="frDB_BaseTable" Session="DBM.OraSession" Active="False" Debug="False" MasterFields="order_id" Params.PropData="04446174610A260000000300000001000000090000003A4F524445525F49440500000005000000323032380000000000" SQL.Text="SELECT&#13;&#10;  g.good_code, g.name, ogi.quantity  &#13;&#10;FROM&#13;&#10;  good g, o_good_item ogi, g_unit gu&#13;&#10;WHERE&#13;&#10;  gu.g_unit_id = ogi.g_unit_id&#13;&#10;  AND gu.good_code = g.good_code&#13;&#10;  AND ogi.order_id = :order_id&#13;&#10;  AND ogi.ignore &#60;&#62; 'Y'&#13;&#10;  AND ogi.STORAGE_CODE in ('0999', '0555')&#13;&#10;ORDER BY ogi.og_item_id" PropData="05704C65667403E8000470546F700234095661726961626C657301010C470000002044617461547970653D226674537472696E6722204E616D653D224F524445525F49442220506172616D547970653D227074556E6B6E6F776E222056616C75653D2232303238220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="20,03149606" Left="0" Top="253,22851" Width="718,1107" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="odsGItems" DataSetName="odsGItems" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="4" Top="0" Width="53,66929134" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSetName="odsItems" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line]"/>
      <TfrxMemoView Name="Memo4" Left="57,07086614" Top="0" Width="371,52755906" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[odsGItems.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="615,68503205" Top="0" Width="104,31496063" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsGItems.&#34;QUANTITY&#34;]"/>
      <TfrxMemoView Name="Memo15" Left="428,59841787" Top="0" Width="187,08661417" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsGItems.&#34;GOOD_CODE&#34;]"/>
    </TfrxMasterData>
    <TfrxColumnHeader Name="ColumnHeader1" Height="172,06299213" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo19" Align="baCenter" Left="301,96877" Top="29,08658" Width="114,17316" Height="20" OnBeforePrint="Memo19OnBeforePrint" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" Text="[odsWerk.&#34;WERK_CODE&#34;] / C0001"/>
      <TfrxMemoView Name="Memo12" Left="4" Top="104" Width="678" Height="21" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="Ð¢Ð¾Ð²Ð°Ñ€, Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð½Ñ‹Ð¹ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ:"/>
      <TfrxMemoView Name="Memo7" Left="4" Top="132" Width="52,88188" Height="40,06299213" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð¿/Ð¿"/>
      <TfrxMemoView Name="Memo8" Left="56,88188" Top="151,93700787" Width="371,68522" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ"/>
      <TfrxMemoView Name="Memo9" Left="56,95269" Top="132" Width="558,61417323" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¢Ð¾Ð²Ð°Ñ€"/>
      <TfrxMemoView Name="Memo11" Left="615,57483" Top="132" Width="104,22047" Height="40,06299213" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾, ÑˆÑ‚ÑƒÐº"/>
      <TfrxMemoView Name="Memo18" Left="428,59841787" Top="151,96073" Width="187,08661417" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ¾Ð¼ÐµÐ½ÐºÐ»Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€"/>
      <TfrxMemoView Name="Memo1" Align="baCenter" Left="85,05535" Top="1,54329" Width="548" Height="25,66141" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="ÐÐšÐ¢ ÐŸÐ•Ð Ð•Ð”ÐÐ§Ð˜ Ð¢ÐžÐ’ÐÐ Ð ÐšÐ›Ð˜Ð•ÐÐ¢Ð£"/>
    </TfrxColumnHeader>
    <TfrxReportSummary Name="ReportSummary1" Height="372,34663" Left="0" Top="332,59864" Width="718,1107">
      <TfrxMemoView Name="Memo13" Left="7,77953" Top="32,91342" Width="704,06308" Height="224,09462" ShowHint="False" AllowHTMLTags="True" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" LineSpacing="15" ParentFont="False" Text="ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ Ð² Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ðµ [&#60;odsWerk.&#34;NAMEBASE&#34;&#62;] [&#60;odsWerk.&#34;ADDR&#34;&#62;] Ð¸ Ð¼Ð½Ð¾ÑŽ Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½. &#13;&#10;ÐŸÑ€ÐµÑ‚ÐµÐ½Ð·Ð¸Ð¹ Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑ‚Ð°Ñ†Ð¸Ð¸ Ð¸ Ð²Ð½ÐµÑˆÐ½ÐµÐ¼Ñƒ Ð²Ð¸Ð´Ñƒ Ð¢Ð¾Ð²Ð°Ñ€Ð° Ð½Ðµ Ð¸Ð¼ÐµÑŽ.&#13;&#10;Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ (Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ, Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ð¹Ð½Ñ‹Ð¹ Ñ‚Ð°Ð»Ð¾Ð½) Ð¸ Ð²ÑÑ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¢Ð¾Ð²Ð°Ñ€Ðµ Ð¼Ð½Ðµ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð°. "/>
      <TfrxMemoView Name="Memo3" Left="8,275665" Top="268,34663" Width="222,99227" Height="22,67718" ShowHint="False" DisplayFormat.FormatStr="dd mmmm yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="4" ParentFont="False" Text="[Now] Ð³."/>
      <TfrxMemoView Name="Memo6" Left="8,275665" Top="325,03958" Width="487,55937" Height="22,67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="ÐŸÐ¾ÐºÑƒÐ¿Ð°Ñ‚ÐµÐ»ÑŒ ________________________(________________)"/>
      <TfrxMemoView Name="Memo10" Left="180,24428" Top="343,93723" Width="60,47248" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(ÐŸÐ¾Ð´Ð¿Ð¸ÑÑŒ)"/>
      <TfrxMemoView Name="Memo14" Left="325,756185" Top="343,93723" Width="132,28355" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¸)"/>
    </TfrxReportSummary>
  </TfrxReportPage>
</TfrxReport>
