<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.30" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38831,7108377431" ReportOptions.Description.Text="" ReportOptions.LastChange="39835,4831532176" ScriptLanguage="PascalScript" ScriptText.Text="procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;    deBeginDate.date := DATE - IIF(DayOfWeek(DATE)-1=0,7,DayOfWeek(DATE)-1)+1+7;&#13;&#10;    deEndDate.date := deBeginDate.date + 6;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button1, Engine do&#13;&#10;  begin&#13;&#10;    odsMain.Close;&#13;&#10;    odsMain.SetVariable('BEGIN_DATE', deBeginDate.Date);&#13;&#10;    odsMain.SetVariable('END_DATE', deEndDate.Date);&#13;&#10;    odsMain.Open;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="08446174617365747301010C3600000020446174615365743D22667244425F426173655461626C652220446174615365744E616D653D22667244425F426173655461626C652200010C2800000020446174615365743D226F64734D61696E2220446174615365744E616D653D226F64734D61696E220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDOAQuery Name="odsMain" UserName="odsMain" CloseDataSource="True" FieldAliases.Text="ON_DATE=ON_DATE&#13;&#10;FULLNAME=FULLNAME&#13;&#10;RANG=RANG&#13;&#10;CATG_ID=CATG_ID&#13;&#10;START_DATETIME=START_DATETIME&#13;&#10;LUNCH_DATETIME=LUNCH_DATETIME&#13;&#10;LUNCH_END=LUNCH_END&#13;&#10;END_DATETIME=END_DATETIME&#13;&#10;WCNT=WCNT" Session="DBM.OraSession" Active="False" Debug="False" Params.PropData="04446174610A3C0000000300000002000000090000003A454E445F444154450C00000000000000000000000B0000003A424547494E5F444154450C0000000000000000000000" SQL.Text="SELECT t1.ON_DATE, t1.FULLNAME, t1.RANG, t1.catg_id,&#13;&#10;       DECODE(t1.ON_DATE, trunc(t1.START_DATETIME), to_char(t1.START_DATETIME, 'hh24:mi'), NULL) AS START_DATETIME,&#13;&#10;       DECODE(t1.ON_DATE, trunc(t1.LUNCH_DATETIME), to_char(t1.LUNCH_DATETIME, 'hh24:mi'), NULL) AS LUNCH_DATETIME,&#13;&#10;       DECODE(t1.ON_DATE, trunc(t1.lunch_end-1/24), to_char(t1.lunch_end, 'hh24:mi'), NULL) AS lunch_end,&#13;&#10;       DECODE(t1.ON_DATE, trunc(t1.END_DATETIME-1/24), to_char(t1.END_DATETIME, 'hh24:mi'), NULL) AS END_DATETIME,&#13;&#10;       24*(DECODE(t1.ON_DATE, trunc(t1.END_DATETIME), t1.END_DATETIME, t1.ON_DATE + 1) -&#13;&#10;         DECODE(t1.ON_DATE, trunc(t1.sdt), t1.sdt, t1.ON_DATE) -&#13;&#10;         decode(t1.LUNCH_DATETIME, NULL, 0, DECODE(t1.ON_DATE, trunc(t1.LUNCH_DATETIME), 1/24, 0))) AS wcnt&#13;&#10;  FROM (SELECT d.ON_DATE, ps.FULLNAME, pr.RANG, tr.catg_id,&#13;&#10;               pdp.START_DATETIME AS sdt,&#13;&#10;               pdp.START_DATETIME - nvl(get_tsoptions('GG_BEFORE_COME'), 0)/24/60 AS START_DATETIME, &#13;&#10;               pdp.LUNCH_DATETIME,&#13;&#10;               pdp.LUNCH_DATETIME + 1/24 AS lunch_end,&#13;&#10;               pdp.END_DATETIME + 1/24 AS END_DATETIME &#13;&#10;          FROM p_staff ps, P_RANG pr, P_DAY_PLAN_TEMP pdp,&#13;&#10;               ( SELECT TO_NUMBER(tr.CH_ID) AS p_staff_id,&#13;&#10;                        to_number(tr.PR_ID) AS rang_id,&#13;&#10;                        to_number(tc.pr_id) as catg_id&#13;&#10;                   FROM ts_tree tr, ts_tree rg, ts_tree tc&#13;&#10;                  WHERE tr.ts_code = 'TRANG'&#13;&#10;                    and rg.TS_CODE = 'TGRANG'&#13;&#10;                    AND rg.pr_id = 'SELLER'&#13;&#10;                    and rg.ch_id = tr.pr_id&#13;&#10;                    and tc.ts_code(+) = 'TWCLASS'&#13;&#10;                    and tc.CH_ID(+) = tr.CH_ID&#13;&#10;               ) tr,&#13;&#10;               (SELECT :begin_date + n.ID - 1 AS on_date&#13;&#10;                  FROM TSYS_NUMBERS n&#13;&#10;                 WHERE n.ID &#60;= :end_date - :begin_date + 1&#13;&#10;               ) d&#13;&#10;         WHERE ps.START_DATE &#60;= :end_date&#13;&#10;           AND (ps.END_DATE IS NULL OR ps.END_DATE &#62;= :begin_date)&#13;&#10;           AND tr.p_staff_id = ps.ID&#13;&#10;           AND pr.ID = tr.rang_id&#13;&#10;           AND pdp.OFF_REASON = 'Ð'&#13;&#10;           AND pdp.P_STAFF_ID = ps.ID&#13;&#10;           AND pdp.START_DATETIME between :begin_date - 1 AND :end_date + 1&#13;&#10;           AND d.ON_DATE BETWEEN trunc(pdp.START_DATETIME) AND trunc(pdp.END_DATETIME)&#13;&#10;        ) t1&#13;&#10; ORDER BY t1.ON_DATE, t1.START_DATETIME, t1.END_DATETIME, t1.LUNCH_DATETIME&#13;&#10;" PropData="05704C656674023C0470546F700214095661726961626C657301010C3C0000002044617461547970653D2266744461746554696D6522204E616D653D22454E445F444154452220506172616D547970653D227074556E6B6E6F776E2200010C3E0000002044617461547970653D2266744461746554696D6522204E616D653D22424547494E5F444154452220506172616D547970653D227074556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Ãèáêèé ãðàôèê (ïî äíÿì)" Height="144" Left="272" Top="219" Width="327" OnActivate="Page1OnBeforePrint">
    <TfrxButtonControl Name="Button1" Left="52" Top="68" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ok" ModalResult="1" OnClick="Button1OnBeforePrint"/>
    <TfrxButtonControl Name="Button2" Left="192" Top="68" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Îòìåíà" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="20" Width="61" Height="13" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Çà ïåðèîä ñ" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="184" Top="20" Width="12" Height="13" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="ïî" Color="-16777201"/>
    <TfrxDateEditControl Name="deBeginDate" Left="84" Top="16" Width="90" Height="21" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="39465" Time="39465"/>
    <TfrxDateEditControl Name="deEndDate" Left="208" Top="16" Width="90" Height="21" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="39465" Time="39465"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="46,45671" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="0" Width="718,1107" Height="42,67718" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="255" Font.Height="-21" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð“Ñ€Ð°Ñ„Ð¸Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² (Ð¿Ð¾ Ð´Ð½ÑÐ¼)&#13;&#10;Ð½Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [deBeginDate.Date #ddd.mm.yyyy] Ð¿Ð¾ [deEndDate.Date #ddd.mm.yyyy]"/>
    </TfrxReportTitle>
    <TfrxPageHeader Name="PageHeader1" Height="23,77953" Left="0" Top="84" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="434,64595" Top="0" Width="284,9765" Height="23,77953" ShowHint="False" StretchMode="smMaxHeight" AutoWidth="True" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="16711680" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="ÐÐºÑ‚ÑƒÐ°Ð»ÐµÐ½ Ð½Ð° [DATE] [TIME]"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="20" Left="0" Top="192" Width="718,1107" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="odsMain" DataSetName="odsMain" RowCount="0">
      <TfrxMemoView Name="Memo12" Left="495,11814929" Top="0" Width="45,35432339" Height="20" ShowHint="False" StretchMode="smMaxHeight" Color="16700346" DataField="START_DATETIME" DataSet="odsMain" DataSetName="odsMain" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;START_DATETIME&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="540,47248" Top="0" Width="86,92915339" Height="20" ShowHint="False" StretchMode="smMaxHeight" Color="65535" DataSet="odsMain" DataSetName="odsMain" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;LUNCH_DATETIME&#34;] - [odsMain.&#34;LUNCH_END&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="627,40158945" Top="0" Width="45,35433071" Height="20" ShowHint="False" StretchMode="smMaxHeight" Color="16700346" DataField="END_DATETIME" DataSet="odsMain" DataSetName="odsMain" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;END_DATETIME&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="0" Top="0" Width="495,11814929" Height="20" ShowHint="False" StretchMode="smMaxHeight" Color="16777180" DataSet="odsMain" DataSetName="odsMain" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;FULLNAME&#34;], [odsMain.&#34;RANG&#34;] [odsMain.&#34;CATG_ID&#34;] ÐºÐ°Ñ‚."/>
      <TfrxMemoView Name="Memo5" Left="672,75634" Top="0" Width="45,35433071" Height="20" ShowHint="False" StretchMode="smMaxHeight" Color="13408511" DataField="WCNT" DataSet="odsMain" DataSetName="odsMain" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;WCNT&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="42,67718" Left="0" Top="128" Width="718,1107" Condition="odsMain.&#34;ON_DATE&#34;" KeepTogether="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="7,55905999999999" Width="495,11814929" Height="35,11812" ShowHint="False" StretchMode="smMaxHeight" Color="16777180" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[odsMain.&#34;ON_DATE&#34;]                                        Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº"/>
      <TfrxMemoView Name="Memo4" Left="495,11814929" Top="7,55905999999999" Width="45,35433071" Height="35,1496063" ShowHint="False" StretchMode="smMaxHeight" Color="16700346" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÑ€Ð¸Ñ…Ð¾Ð´"/>
      <TfrxMemoView Name="Memo6" Left="540,47248" Top="7,55905999999999" Width="86,92913386" Height="35,11812" ShowHint="False" StretchMode="smMaxHeight" Color="65535" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐžÐ±ÐµÐ´"/>
      <TfrxMemoView Name="Memo7" Left="627,40158945" Top="7,55905999999999" Width="45,35433071" Height="35,11812" ShowHint="False" StretchMode="smMaxHeight" Color="16700346" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð£Ñ…Ð¾Ð´"/>
      <TfrxMemoView Name="Memo9" Left="672,75634" Top="7,55905999999999" Width="45,35433071" Height="35,11812" ShowHint="False" StretchMode="smMaxHeight" Color="13408511" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð§Ð°ÑÐ¾Ð²"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
